<div class="row justify-content-center">
  <div class="form-group mt-3 col-md-5" style="max-width: 300px">
    <form action="/" method="GET" class="mt-3">
      <select class="form-select" name="category" id="category-filter" data-value="{{category}}" onchange="submit()">
        <option value="" selected>全部類別</option>
        {{#each categories}}
        <option value="{{this._id}}">{{this.name}}</option>
        {{/each}}
      </select>
    </form>
  </div>

  <div class="form-group mt-3 col-md-5" style="max-width: 300px">
    <form action="/" method="GET" class="mt-3">
      <select class="form-select" name="month" id="month-filter" data-value="{{month}}" onchange="submit()">
        <option value="" selected>所有月份</option>
        <option value="Jan">January</option>
        <option value="Feb">February</option>
        <option value="Mar">March</option>
        <option value="Apr">April</option>
        <option value="May">May</option>
        <option value="Jun">June</option>
        <option value="Jul">July</option>
        <option value="Aug">August</option>
        <option value="Sep">September</option>
        <option value="Oct">October</option>
        <option value="Nov">November</option>
        <option value="Dec">December</option>
      </select>
    </form>
  </div>

  <div class="row justify-content-center mt-5">
    <div class="row col-md-8 col-lg-6 col-xl-5 justify-content-around">
      <div class="col-auto" style="font-size: 25px;">總金額：</div>
      <div class="col-auto text-end text-danger" style="font-size: 100px;">{{totalAmount}}</div>
    </div>
  </div>
</div>

<div class="row justify-content-center">
  <ul class="list-group col-md-10 col-xs-12" style="max-width: 560px">
    {{#each records}}
      <div class="list-group-item row">
        <div class="d-flex justify-content-around">
          <i class="fas {{this.category.icon}} fa-3x"></i>
          <div class="col-4 d-flex">
            <div class="row col-8">
              <p>{{this.name}}</pd>
              <p>{{showDate this.date}}</p>  
            </div>
            <p class="d-flex align-items-center col-4 justify-content-center">$ {{this.amount}}</p>              
          </div>
          <p class="d-flex align-items-center">{{this.merchant}}</p>
          <div class="col-3 d-flex align-items-center justify-content-around">
            <a href="/records/{{this._id}}/edit" class="btn btn-info">Edit</a>
            <form action="./records/{{this._id}}?_method=DELETE" method="post">
              <button type="submit" class="btn btn-danger">Delete</button>
            </form>
          </div>
        </div>
      </div>
    {{/each}}
  </ul>
</div>

<div class="row justify-content-center mt-3">
  <a href="./records/new" class="btn btn-success btn-lg col-5" style="max-width: 290px;">新增支出</a>
</div>

<script>
  const categoryFilter = document.querySelector('#category-filter')
  categoryFilter.value = categoryFilter.dataset.value
  categoryFilter.addEventListener('change', () => categoryFilter.parentElement.submit())
</script>